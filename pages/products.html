<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Products - Mother Care</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../css/style.css">
</head>

<body>
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm sticky-top">
        <div class="container">
            <a class="navbar-brand fw-bold" href="../index.html">
                <img data-business-logo class="d-none me-1" style="height: 30px; width: auto;" alt="Business logo">
                <i class="fas fa-baby"></i> <span data-business-name>Mother Care</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="products.html">Products</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="cart.html">
                            <i class="fas fa-shopping-cart"></i> Cart <span class="badge bg-danger"
                                id="cartCount">0</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link btn btn-sm btn-primary text-white ms-2" href="login.html" data-admin-link>
                            <i class="fas fa-sign-in-alt"></i> Staff Login
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Page Header -->
    <div class="bg-light py-4">
        <div class="container">
            <h1 class="mb-0"><i class="fas fa-shopping-bag"></i> Our Products</h1>
            <p class="text-muted">Browse our complete collection of premium mother care products</p>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container py-5">
        <div class="row">
            <!-- Sidebar Filters -->
            <div class="col-lg-3 mb-4">
                <div class="card">
                    <div class="card-header bg-light">
                        <h5 class="mb-0"><i class="fas fa-filter"></i> Filters</h5>
                    </div>
                    <div class="card-body">
                        <!-- Category Filter -->
                        <div class="mb-4">
                            <label class="form-label fw-bold">Categories</label>
                            <div id="categoryFilter">
                                <div class="form-check">
                                    <input class="form-check-input category-filter" type="checkbox" value="all" id="all"
                                        checked>
                                    <label class="form-check-label" for="all">All</label>
                                </div>
                            </div>
                        </div>

                        <!-- Price Range Filter -->
                        <div class="mb-4">
                            <label class="form-label fw-bold">Price Range</label>
                            <div class="d-flex gap-2 mb-2">
                                <input type="number" class="form-control form-control-sm" id="minPrice"
                                    placeholder="Min">
                                <input type="number" class="form-control form-control-sm" id="maxPrice"
                                    placeholder="Max">
                            </div>
                            <button class="btn btn-sm btn-primary w-100" onclick="filterByPrice()">Apply</button>
                        </div>

                        <!-- Sort -->
                        <div class="mb-4">
                            <label class="form-label fw-bold">Sort By</label>
                            <select class="form-select form-select-sm" id="sortBy" onchange="sortProducts()">
                                <option value="newest">Newest</option>
                                <option value="price-low">Price: Low to High</option>
                                <option value="price-high">Price: High to Low</option>
                                <option value="popular">Most Popular</option>
                            </select>
                        </div>

                        <button class="btn btn-secondary w-100" onclick="resetFilters()">Reset Filters</button>
                    </div>
                </div>
            </div>

            <!-- Products Grid -->
            <div class="col-lg-9">
                <div id="productsContainer" class="row">
                    <!-- Products loaded via JavaScript -->
                    <div class="col-md-6 mb-4">
                        <div class="placeholder-glow">
                            <div class="card placeholder-wave">
                                <div class="card-body">
                                    <span class="placeholder col-6"></span>
                                    <span class="placeholder col-5"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 mb-4">
                        <div class="placeholder-glow">
                            <div class="card placeholder-wave">
                                <div class="card-body">
                                    <span class="placeholder col-6"></span>
                                    <span class="placeholder col-5"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer-mosaic text-white py-5">
        <div class="container">
            <div class="row g-3">
                <div class="col-md-4 mb-4">
                    <div class="footer-brand-card">
                        <h5><i class="fas fa-baby me-2"></i><span data-business-name>Mother Care</span></h5>
                        <p>Smart picks for daily baby care, with quality and comfort at the center of every product.</p>
                    </div>
                </div>
                <div class="col-md-4 mb-4">
                    <div class="footer-brand-card">
                        <h5 class="mb-2">Quick Links</h5>
                        <div class="footer-stack-links">
                            <a href="../index.html"><span>Home</span><i class="fas fa-arrow-right"></i></a>
                            <a href="products.html"><span>Products</span><i class="fas fa-arrow-right"></i></a>
                            <a href="cart.html"><span>Cart</span><i class="fas fa-arrow-right"></i></a>
                            <a href="contact.html"><span>Contact</span><i class="fas fa-arrow-right"></i></a>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-4">
                    <div class="footer-brand-card">
                        <h5 class="mb-2">Contact Info</h5>
                        <div class="footer-meta-grid">
                            <div class="footer-meta-item">
                                <i class="fas fa-phone"></i>
                                <span data-business-phone>+233 000 000 000</span>
                            </div>
                            <div class="footer-meta-item">
                                <i class="fas fa-envelope"></i>
                                <span data-business-email>info@mothercare.com</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <hr class="bg-white-50 opacity-50">
            <div class="text-center footer-footnote">
                <p>&copy; 2026 <span data-business-name>Mother Care</span>. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../js/business-info.js"></script>
    <script src="../js/scripts.js?v=20260224-4"></script>
    <script>
        // Load all products
        function loadProducts() {
            const container = document.getElementById('productsContainer');

            fetch(withTenantQuery('../php/get-products.php?limit=24'))
                .then(response => response.json())
                .then(data => {
                    container.innerHTML = '';

                    if (data.success && data.products.length > 0) {
                        const cards = data.products.map((product) => {
                            const productId = Number(product.id || 0);
                            const productPrice = Number(product.price || 0);
                            const productStock = Number(product.stock || 0);
                            const productCategory = escapeHtml(String(product.category || ''));
                            const productNameRaw = String(product.name || '');
                            const productName = escapeHtml(productNameRaw);
                            const productDescription = escapeHtml(String(product.description || ''));
                            const productImage = sanitizeImageFilename(product.image || '');
                            const productNameAttr = escapeHtml(productNameRaw);
                            const productImageAttr = escapeHtml(productImage);

                            return `
                                <div class="col-md-6 col-lg-4 mb-4 product-item" data-category="${productCategory}" data-price="${productPrice}">
                                    <div class="card product-card product-card-clickable" role="button" tabindex="0" aria-label="Add ${productName} to cart" data-product-id="${productId}" data-product-name="${productNameAttr}" data-product-price="${productPrice}" data-product-image="${productImageAttr}" onclick="addToCartFromElement(this)" onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();addToCartFromElement(this);}">
                                        <img src="../assets/images/${productImage}" class="card-img-top" alt="${productName}" loading="lazy" decoding="async">
                                        <div class="card-body">
                                            <h5 class="card-title">${productName}</h5>
                                            <p class="card-text text-muted text-truncate">${productDescription}</p>
                                            <div class="d-flex justify-content-between align-items-center mb-2">
                                                <span class="product-price">GBP ${productPrice.toFixed(2)}</span>
                                                <span class="badge bg-info">${productCategory}</span>
                                            </div>
                                            <div class="d-flex justify-content-between align-items-center mb-3">
                                                <span class="text-muted small">${productStock} in stock</span>
                                            </div>
                                            <button type="button" class="btn btn-primary btn-sm w-100" data-product-id="${productId}" data-product-name="${productNameAttr}" data-product-price="${productPrice}" data-product-image="${productImageAttr}" onclick="event.stopPropagation(); addToCartFromElement(this)">
                                                <i class="fas fa-shopping-cart"></i> Add to Cart
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            `;
                        });
                        container.innerHTML = cards.join('');
                    } else {
                        container.innerHTML = '<div class="col-12"><p class="text-center text-muted">No products available.</p></div>';
                    }
                })
                .catch(error => {
                    console.error('Error loading products:', error);
                    container.innerHTML = '<div class="col-12"><p class="text-center text-danger">Error loading products.</p></div>';
                });
        }

        function filterByPrice() {
            const minPrice = parseFloat(document.getElementById('minPrice').value) || 0;
            const maxPrice = parseFloat(document.getElementById('maxPrice').value) || Infinity;
            const products = document.querySelectorAll('.product-item');

            products.forEach(product => {
                const price = parseFloat(product.dataset.price);
                if (price >= minPrice && price <= maxPrice) {
                    product.style.display = 'block';
                } else {
                    product.style.display = 'none';
                }
            });
        }

        function resetFilters() {
            document.getElementById('minPrice').value = '';
            document.getElementById('maxPrice').value = '';
            document.getElementById('sortBy').value = 'newest';
            document.querySelectorAll('.product-item').forEach(item => {
                item.style.display = 'block';
            });
        }

        function sortProducts() {
            const sortBy = document.getElementById('sortBy').value;
            const container = document.getElementById('productsContainer');
            const products = Array.from(document.querySelectorAll('.product-item'));

            products.sort((a, b) => {
                if (sortBy === 'price-low') {
                    return parseFloat(a.dataset.price) - parseFloat(b.dataset.price);
                } else if (sortBy === 'price-high') {
                    return parseFloat(b.dataset.price) - parseFloat(a.dataset.price);
                }
                return 0;
            });

            container.innerHTML = '';
            products.forEach(product => {
                container.appendChild(product);
            });
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function () {
            updateCartCount();
            loadProducts();
        });
    </script>
</body>

</html>






